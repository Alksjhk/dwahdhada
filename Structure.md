# é¡¹ç›®ç»“æ„è¯´æ˜

## ğŸ“ æ•´ä½“ç»“æ„

```
dwahdhada/
â”œâ”€â”€ .claude/                    # Claude AI é…ç½®
â”œâ”€â”€ .git/                       # Git ç‰ˆæœ¬æ§åˆ¶
â”œâ”€â”€ .vscode/                    # VS Code é…ç½®
â”œâ”€â”€ client/                     # å‰ç«¯é¡¹ç›® (React + TypeScript + Vite)
â”œâ”€â”€ server/                     # åç«¯é¡¹ç›® (Express + TypeScript)
â”œâ”€â”€ node_modules/               # æ ¹ç›®å½•ä¾èµ–
â”œâ”€â”€ .gitignore                  # Git å¿½ç•¥æ–‡ä»¶
â”œâ”€â”€ package.json                # æ ¹ç›®å½•åŒ…é…ç½®
â”œâ”€â”€ start.js                    # åˆå¹¶éƒ¨ç½²å¯åŠ¨è„šæœ¬
â”œâ”€â”€ MERGE_DEPLOY.md             # åˆå¹¶éƒ¨ç½²è¯´æ˜
â”œâ”€â”€ README.md                   # é¡¹ç›®è¯´æ˜æ–‡æ¡£
â”œâ”€â”€ Technical.md                # æŠ€æœ¯æ–‡æ¡£
â”œâ”€â”€ Structure.md                # ç»“æ„è¯´æ˜ (æœ¬æ–‡ä»¶)
â””â”€â”€ Deployment.md               # éƒ¨ç½²æŒ‡å—
```

## ğŸ¯ å‰ç«¯é¡¹ç›® (client/)

```
client/
â”œâ”€â”€ node_modules/               # å‰ç«¯ä¾èµ–
â”œâ”€â”€ public/                     # é™æ€èµ„æº
â”‚   â””â”€â”€ vite.svg               # Vite å›¾æ ‡
â”œâ”€â”€ scripts/                    # æ„å»ºè„šæœ¬
â”‚   â””â”€â”€ setup-env.js           # ç¯å¢ƒè®¾ç½®è„šæœ¬ (æ”¯æŒå¤šç¯å¢ƒ)
â”œâ”€â”€ src/                        # æºä»£ç 
â”‚   â”œâ”€â”€ assets/                # é™æ€èµ„æº
â”‚   â”œâ”€â”€ components/            # React ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ ChatContainer.tsx  # èŠå¤©ä¸»å®¹å™¨
â”‚   â”‚   â”œâ”€â”€ ChatHeader.tsx     # å¤´éƒ¨ç»„ä»¶ (ç§»é™¤Avatarä¾èµ–)
â”‚   â”‚   â”œâ”€â”€ MessageList.tsx    # æ¶ˆæ¯åˆ—è¡¨
â”‚   â”‚   â”œâ”€â”€ MessageInput.tsx   # æ¶ˆæ¯è¾“å…¥ (æ”¯æŒç›¸å¯¹è·¯å¾„ä¸Šä¼ )
â”‚   â”‚   â”œâ”€â”€ RoomSelector.tsx   # æˆ¿é—´é€‰æ‹©å™¨
â”‚   â”‚   â”œâ”€â”€ LoginForm.tsx      # ç™»å½•è¡¨å•
â”‚   â”‚   â”œâ”€â”€ ConnectionStatus.tsx # è¿æ¥çŠ¶æ€æŒ‡ç¤ºå™¨
â”‚   â”‚   â””â”€â”€ ui/                # UIç»„ä»¶åº“
â”‚   â”‚       â”œâ”€â”€ Button.tsx     # æŒ‰é’®ç»„ä»¶
â”‚   â”‚       â”œâ”€â”€ Input.tsx      # è¾“å…¥æ¡†ç»„ä»¶
â”‚   â”‚       â””â”€â”€ index.ts       # UIç»„ä»¶å¯¼å‡º (ç§»é™¤Avatar)
â”‚   â”œâ”€â”€ config/                # é…ç½®æ–‡ä»¶
â”‚   â”‚   â””â”€â”€ api.ts             # APIé…ç½® (å¤„ç†ç©ºbaseURL)
â”‚   â”œâ”€â”€ context/               # React ContextçŠ¶æ€ç®¡ç†
â”‚   â”‚   â””â”€â”€ ChatContext.tsx
â”‚   â”œâ”€â”€ component/             # ç‰¹æ•ˆç»„ä»¶
â”‚   â”‚   â””â”€â”€ Aurora.tsx         # æå…‰èƒŒæ™¯ç‰¹æ•ˆ
â”‚   â”œâ”€â”€ utils/                 # å·¥å…·å‡½æ•°
â”‚   â”‚   â”œâ”€â”€ SSEManager.ts      # SSEå®¢æˆ·ç«¯ç®¡ç†å™¨
â”‚   â”‚   â””â”€â”€ api.ts             # Axios APIå®¢æˆ·ç«¯ (æ”¯æŒç›¸å¯¹è·¯å¾„)
â”‚   â”œâ”€â”€ types.ts               # TypeScriptç±»å‹å®šä¹‰
â”‚   â”œâ”€â”€ App.tsx                # åº”ç”¨å…¥å£ (ç§»é™¤NicknameForm)
â”‚   â”œâ”€â”€ App.css                # ä¸»åº”ç”¨æ ·å¼
â”‚   â”œâ”€â”€ index.css              # å…¨å±€æ ·å¼
â”‚   â””â”€â”€ main.tsx               # Viteå…¥å£
â”œâ”€â”€ .env                       # ç¯å¢ƒå˜é‡ (ç”Ÿäº§ç¯å¢ƒé…ç½®)
â”œâ”€â”€ package.json               # å‰ç«¯åŒ…é…ç½®
â”œâ”€â”€ vite.config.ts             # Vite é…ç½®
â”œâ”€â”€ tsconfig.json              # TypeScript é…ç½®
â”œâ”€â”€ tsconfig.app.json          # åº”ç”¨ TS é…ç½®
â””â”€â”€ tsconfig.node.json         # Node TS é…ç½®
```

### å‰ç«¯ç»„ä»¶å˜æ›´è®°å½•
- âœ… **ç§»é™¤**: `NicknameForm.tsx` - ç®€åŒ–ç™»å½•æµç¨‹ï¼Œæ— éœ€æ˜µç§°è®¾ç½®
- âœ… **ç§»é™¤**: `ui/Avatar.tsx` - UIç®€åŒ–ï¼Œç§»é™¤å¤´åƒæ˜¾ç¤º
- âœ… **ç§»é™¤**: `ui/Avatar.module.css` - å¤´åƒæ ·å¼æ–‡ä»¶
- âœ… **ä¿®æ”¹**: `ChatHeader.tsx` - ç§»é™¤Avatarç»„ä»¶å¼•ç”¨
- âœ… **ä¿®æ”¹**: `MessageBubble.tsx` - ç§»é™¤Avatarç»„ä»¶å¼•ç”¨
- âœ… **ä¿®æ”¹**: `MessageBubble.module.css` - ç§»é™¤avataræ ·å¼
- âœ… **ä¿®æ”¹**: `ui/index.ts` - ç§»é™¤Avatarå¯¼å‡º
- âœ… **ä¿®æ”¹**: `App.tsx` - ç§»é™¤NicknameFormç›¸å…³é€»è¾‘
- âœ… **ä¿®æ”¹**: `MessageInput.tsx` - æ”¯æŒç›¸å¯¹è·¯å¾„æ–‡ä»¶ä¸Šä¼ 
- âœ… **ä¿®æ”¹**: `config/api.ts` - å¤„ç†ç©ºbaseURL
- âœ… **ä¿®æ”¹**: `utils/api.ts` - æ”¯æŒç›¸å¯¹è·¯å¾„

## ğŸš€ åç«¯é¡¹ç›® (server/)

```
server/
â”œâ”€â”€ database/                   # æ•°æ®åº“æ–‡ä»¶
â”‚   â”œâ”€â”€ .gitkeep               # ä¿æŒç›®å½•
â”‚   â””â”€â”€ chat.db                # SQLite æ•°æ®åº“
â”œâ”€â”€ node_modules/               # åç«¯ä¾èµ–
â”œâ”€â”€ src/                        # æºä»£ç 
â”‚   â”œâ”€â”€ controllers/           # æ§åˆ¶å™¨
â”‚   â”‚   â”œâ”€â”€ fileController.ts  # æ–‡ä»¶æ§åˆ¶å™¨
â”‚   â”‚   â”œâ”€â”€ messageController.ts # æ¶ˆæ¯æ§åˆ¶å™¨
â”‚   â”‚   â”œâ”€â”€ roomController.ts  # æˆ¿é—´æ§åˆ¶å™¨
â”‚   â”‚   â””â”€â”€ sseController.ts   # SSEæ§åˆ¶å™¨
â”‚   â”œâ”€â”€ database/              # æ•°æ®åº“ç›¸å…³
â”‚   â”‚   â”œâ”€â”€ init.ts            # æ•°æ®åº“åˆå§‹åŒ–
â”‚   â”‚   â””â”€â”€ migrate.ts         # æ•°æ®åº“è¿ç§»
â”‚   â”œâ”€â”€ routes/                # è·¯ç”±
â”‚   â”‚   â”œâ”€â”€ fileRoutes.ts      # æ–‡ä»¶è·¯ç”±
â”‚   â”‚   â”œâ”€â”€ messageRoutes.ts   # æ¶ˆæ¯è·¯ç”±
â”‚   â”‚   â”œâ”€â”€ roomRoutes.ts      # æˆ¿é—´è·¯ç”±
â”‚   â”‚   â””â”€â”€ sseRoutes.ts       # SSEè·¯ç”±
â”‚   â”œâ”€â”€ utils/                 # å·¥å…·ç±»
â”‚   â”‚   â”œâ”€â”€ database.ts        # æ•°æ®åº“å·¥å…·
â”‚   â”‚   â””â”€â”€ SSEManager.ts      # SSEæœåŠ¡ç«¯ç®¡ç†å™¨
â”‚   â”œâ”€â”€ types.ts               # TypeScriptç±»å‹å®šä¹‰
â”‚   â””â”€â”€ app.ts                 # åº”ç”¨å…¥å£ (æ”¯æŒåˆå¹¶éƒ¨ç½²)
â”œâ”€â”€ uploads/                    # æ–‡ä»¶ä¸Šä¼ ç›®å½•
â”‚   â””â”€â”€ .gitkeep               # ä¿æŒç›®å½•
â”œâ”€â”€ .env                       # ç¯å¢ƒå˜é‡
â”œâ”€â”€ package.json               # åç«¯åŒ…é…ç½®
â”‚   â””â”€â”€ scripts:
â”‚       â”œâ”€â”€ dev                # å¼€å‘æ¨¡å¼
â”‚       â”œâ”€â”€ build              # æ„å»º
â”‚       â”œâ”€â”€ start              # ç”Ÿäº§å¯åŠ¨
â”‚       â””â”€â”€ merge              # åˆå¹¶éƒ¨ç½²å¯åŠ¨
â””â”€â”€ tsconfig.json              # TypeScript é…ç½®
```

### åç«¯æ ¸å¿ƒå˜æ›´
- âœ… **ä¿®æ”¹**: `src/app.ts` - æ”¯æŒåˆå¹¶éƒ¨ç½²
  - é™æ€æ–‡ä»¶æœåŠ¡: æä¾› `client/dist` ç›®å½•
  - SPAè·¯ç”±: æ‰€æœ‰éAPIè¯·æ±‚è¿”å›index.html
  - CORSé…ç½®: æ”¯æŒç¯å¢ƒå˜é‡é…ç½®
  - æ—¥å¿—ä¼˜åŒ–: ç”Ÿäº§ç¯å¢ƒç²¾ç®€æ—¥å¿—
  - é”™è¯¯å¤„ç†: åŒºåˆ†å¼€å‘/ç”Ÿäº§ç¯å¢ƒé”™è¯¯ä¿¡æ¯

## ğŸ”§ é…ç½®æ–‡ä»¶è¯´æ˜

### æ ¹ç›®å½•é…ç½®

- **package.json**: æ ¹ç›®å½•åŒ…é…ç½®ï¼ŒåŒ…å«å¼€å‘è„šæœ¬
- **start.js**: åˆå¹¶éƒ¨ç½²ä¸€é”®å¯åŠ¨è„šæœ¬
  - æ£€æŸ¥å‰ç«¯æ„å»ºå®Œæ•´æ€§
  - å¯åŠ¨åç«¯æœåŠ¡å™¨
  - æä¾›è®¿é—®æŒ‡å¼•

### å‰ç«¯é…ç½®

- **vite.config.ts**: Vite æ„å»ºå·¥å…·é…ç½®
- **.env**: ç”Ÿäº§ç¯å¢ƒé…ç½® (ç©ºbaseURLï¼Œç›¸å¯¹è·¯å¾„)
- **scripts/setup-env.js**: å¤šç¯å¢ƒé…ç½®ç”Ÿæˆå™¨

### åç«¯é…ç½®

- **tsconfig.json**: TypeScript ç¼–è¯‘é…ç½®
- **.env**: æœåŠ¡å™¨ç¯å¢ƒå˜é‡ (ç«¯å£ã€æ•°æ®åº“è·¯å¾„ç­‰)
- **package.json mergeè„šæœ¬**: åˆå¹¶éƒ¨ç½²å‘½ä»¤

## ğŸ“¦ ä¾èµ–ç®¡ç†

### Bun åŒ…ç®¡ç†

- ä½¿ç”¨ `bun install` å®‰è£…ä¾èµ–
- ç”Ÿæˆ `bun.lockb` é”æ–‡ä»¶
- æ”¯æŒ npm ç”Ÿæ€ç³»ç»Ÿ

### ä¾èµ–åˆ†å±‚

1. **æ ¹ç›®å½•**: å¯åŠ¨è„šæœ¬ä¾èµ–
2. **å‰ç«¯**: React 18 + TypeScript + Vite + Axios + CSS Modules
3. **åç«¯**: Express 4 + SQLite3 + TypeScript + Multer + CORS

## ğŸš€ å¯åŠ¨å‘½ä»¤

### å¼€å‘ç¯å¢ƒ (å‰åç«¯åˆ†ç¦»)

```bash
# ä¸€é”®å¯åŠ¨
bun run dev

# åˆ†åˆ«å¯åŠ¨
bun run client:dev  # å‰ç«¯: http://localhost:5173
bun run server:dev  # åç«¯: http://localhost:3001
```

### ç”Ÿäº§ç¯å¢ƒ (åˆå¹¶éƒ¨ç½²)

```bash
# æ–¹å¼1: ä½¿ç”¨å¯åŠ¨è„šæœ¬ (æ¨è)
bun start.js

# æ–¹å¼2: æ‰‹åŠ¨æ„å»ºå¹¶å¯åŠ¨
cd client && bun run build
cd ../server && bun run merge

# æ–¹å¼3: ä½¿ç”¨npmè„šæœ¬
cd server && bun run merge
```

**è®¿é—®**: `http://localhost:3001`

## ğŸ—‚ï¸ æ–‡ä»¶ç±»å‹è¯´æ˜

### ä¿ç•™çš„æ–‡ä»¶

- âœ… æºä»£ç æ–‡ä»¶ (.ts, .tsx)
- âœ… é…ç½®æ–‡ä»¶ (tsconfig.json, vite.config.ts)
- âœ… åŒ…é…ç½®æ–‡ä»¶ (package.json)
- âœ… ç¯å¢ƒå˜é‡æ–‡ä»¶ (.env)
- âœ… æ–‡æ¡£æ–‡ä»¶ (.md)
- âœ… å¯åŠ¨è„šæœ¬ (start.js)

### å·²åˆ é™¤çš„æ–‡ä»¶

- âŒ `client/src/components/NicknameForm.tsx`
- âŒ `client/src/components/NicknameForm.module.css`
- âŒ `client/src/components/ui/Avatar.tsx`
- âŒ `client/src/components/ui/Avatar.module.css`

## ğŸ“‹ ç»´æŠ¤å»ºè®®

1. **ä¾èµ–ç®¡ç†**: ä½¿ç”¨ `bun install` ç»Ÿä¸€ç®¡ç†ä¾èµ–
2. **ç‰ˆæœ¬æ§åˆ¶**: æäº¤ `bun.lockb` ç¡®ä¿ä¸€è‡´æ€§
3. **ç¯å¢ƒé…ç½®**: ä½¿ç”¨ `setup-env.js` ç”Ÿæˆç¯å¢ƒæ–‡ä»¶
4. **æ–‡æ¡£åŒæ­¥**: ä¿æŒæ‰€æœ‰æ–‡æ¡£ä¸ä»£ç å˜æ›´åŒæ­¥
5. **åˆå¹¶éƒ¨ç½²**: ç”Ÿäº§ç¯å¢ƒä¼˜å…ˆä½¿ç”¨åˆå¹¶éƒ¨ç½²æ¨¡å¼

## ğŸ”„ éƒ¨ç½²æµç¨‹

### å¼€å‘ç¯å¢ƒ
```
bun run dev â†’ å‰ç«¯(5173) + åç«¯(3001) â†’ Viteä»£ç†åˆ°åç«¯
```

### ç”Ÿäº§ç¯å¢ƒ (åˆå¹¶éƒ¨ç½²)
```
1. cd client && bun run build     â†’ ç”Ÿæˆdist/
2. cd ../server && bun run merge  â†’ å¯åŠ¨ExpressæœåŠ¡
3. è®¿é—® http://localhost:3001      â†’ å•ç«¯å£è®¿é—®å‰åç«¯
```

**ä¼˜åŠ¿**:
- å•ç«¯å£éƒ¨ç½²ï¼Œç®€åŒ–ç½‘ç»œé…ç½®
- ç›¸å¯¹è·¯å¾„APIè°ƒç”¨ï¼Œæ— éœ€é…ç½®åŸŸå
- Expressç›´æ¥æä¾›é™æ€æ–‡ä»¶
- é€‚åˆå®¹å™¨åŒ–éƒ¨ç½²


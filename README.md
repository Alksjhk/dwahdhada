# è½»é‡çº§ç½‘é¡µèŠå¤©ç³»ç»Ÿ

åŸºäº React + Node.js + SQLite çš„è½»é‡çº§å®æ—¶èŠå¤©ç³»ç»Ÿï¼Œæ”¯æŒå…¬å…±å¤§å…å’Œç§å¯†æˆ¿é—´åŠŸèƒ½ï¼Œä½¿ç”¨ Server-Sent Events (SSE) å®ç°å®æ—¶æ¶ˆæ¯æ¨é€ã€‚

## åŠŸèƒ½ç‰¹æ€§

- **æ— éœ€æ³¨å†Œç™»å½•** - è¾“å…¥è‡ªå®šä¹‰IDå³å¯å¼€å§‹èŠå¤©
- **å…¬å…±å¤§å…** - é»˜è®¤è¿›å…¥çš„å…¬å…±èŠå¤©å®¤
- **ç§å¯†æˆ¿é—´** - 6ä½æ•°å­—æˆ¿é—´å·ï¼Œæ”¯æŒåˆ›å»ºå’ŒåŠ å…¥
- **å®æ—¶æ¶ˆæ¯** - Server-Sent Events (SSE) å®æ—¶æ¶ˆæ¯æ¨é€
- **æ–‡ä»¶ä¸Šä¼ ** - æ”¯æŒå›¾ç‰‡ã€æ–‡æ¡£ç­‰ï¼ˆæœ€å¤§10MBï¼‰
- **å“åº”å¼è®¾è®¡** - æ”¯æŒæ¡Œé¢ç«¯å’Œç§»åŠ¨ç«¯
- **æ¶ˆæ¯æŒä¹…åŒ–** - SQLiteæ•°æ®åº“å­˜å‚¨

## æŠ€æœ¯æ ˆ

| å±‚çº§ | æŠ€æœ¯ |
|------|------|
| å‰ç«¯ | React 18 + TypeScript + Vite + Axios + CSS Modules + SSE |
| åç«¯ | Node.js + Express + SQLite3 + TypeScript + Multer + SSE |
| åŒ…ç®¡ç† | Bun 1.0+ |
| çŠ¶æ€ç®¡ç† | React Context + useReducer |

**æ ¸å¿ƒç‰¹æ€§ï¼š**
- âœ… Server-Sent Events (SSE) å®æ—¶æ¶ˆæ¯æ¨é€
- âœ… React Context + useReducer çŠ¶æ€ç®¡ç†
- âœ… æ–‡ä»¶ä¸Šä¼ æ”¯æŒ (multer, æœ€å¤§10MB)
- âœ… TypeScript å…¨æ ˆç±»å‹å®‰å…¨
- âœ… CSS Modules ç»„ä»¶åŒ–æ ·å¼

## å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚
- Node.js 18+
- Bun 1.0+

### å®‰è£…å¯åŠ¨

```bash
# å…‹éš†é¡¹ç›®
git clone https://github.com/your-username/web-chat-system.git
cd web-chat-system

# å®‰è£…ä¾èµ–
bun run install:all

# å¯åŠ¨å¼€å‘ç¯å¢ƒ
bun run dev
```

è®¿é—® `http://localhost:5173`

## é¡¹ç›®ç»“æ„

```
web-chat-system/
â”œâ”€â”€ client/                     # å‰ç«¯é¡¹ç›® (React + TypeScript + Vite)
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ components/         # Reactç»„ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ ChatContainer.tsx    # èŠå¤©ä¸»å®¹å™¨
â”‚   â”‚   â”‚   â”œâ”€â”€ ChatHeader.tsx       # å¤´éƒ¨ç»„ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ MessageList.tsx      # æ¶ˆæ¯åˆ—è¡¨
â”‚   â”‚   â”‚   â”œâ”€â”€ MessageInput.tsx     # æ¶ˆæ¯è¾“å…¥
â”‚   â”‚   â”‚   â”œâ”€â”€ RoomSelector.tsx     # æˆ¿é—´é€‰æ‹©å™¨
â”‚   â”‚   â”‚   â”œâ”€â”€ LoginForm.tsx        # ç™»å½•è¡¨å•
â”‚   â”‚   â”‚   â”œâ”€â”€ NicknameForm.tsx     # æ˜µç§°è®¾ç½®
â”‚   â”‚   â”‚   â”œâ”€â”€ ConnectionStatus.tsx # è¿æ¥çŠ¶æ€
â”‚   â”‚   â”‚   â””â”€â”€ ui/                  # UIç»„ä»¶åº“
â”‚   â”‚   â”œâ”€â”€ context/            # React ContextçŠ¶æ€ç®¡ç†
â”‚   â”‚   â”‚   â””â”€â”€ ChatContext.tsx
â”‚   â”‚   â”œâ”€â”€ hooks/              # è‡ªå®šä¹‰Hooks
â”‚   â”‚   â”‚   â””â”€â”€ useResponsive.ts
â”‚   â”‚   â”œâ”€â”€ utils/              # å·¥å…·å‡½æ•°
â”‚   â”‚   â”‚   â”œâ”€â”€ SSEManager.ts   # SSEå®¢æˆ·ç«¯ç®¡ç†å™¨
â”‚   â”‚   â”‚   â”œâ”€â”€ api.ts          # Axios APIå®¢æˆ·ç«¯
â”‚   â”‚   â”‚   â””â”€â”€ MessagePoller.ts # è½®è¯¢æœºåˆ¶(å¤‡ç”¨)
â”‚   â”‚   â”œâ”€â”€ config/             # é…ç½®æ–‡ä»¶
â”‚   â”‚   â”‚   â””â”€â”€ api.ts
â”‚   â”‚   â”œâ”€â”€ component/          # ç‰¹æ•ˆç»„ä»¶
â”‚   â”‚   â”‚   â””â”€â”€ Aurora.tsx      # æå…‰èƒŒæ™¯ç‰¹æ•ˆ
â”‚   â”‚   â”œâ”€â”€ types.ts            # TypeScriptç±»å‹å®šä¹‰
â”‚   â”‚   â”œâ”€â”€ App.tsx             # åº”ç”¨å…¥å£
â”‚   â”‚   â””â”€â”€ main.tsx            # Viteå…¥å£
â”‚   â”œâ”€â”€ .env                   # ç¯å¢ƒå˜é‡
â”‚   â”œâ”€â”€ package.json
â”‚   â”œâ”€â”€ vite.config.ts
â”‚   â””â”€â”€ tsconfig.json
â”œâ”€â”€ server/                     # åç«¯é¡¹ç›® (Express + TypeScript)
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ controllers/        # æ§åˆ¶å™¨
â”‚   â”‚   â”‚   â”œâ”€â”€ messageController.ts  # æ¶ˆæ¯å¤„ç†
â”‚   â”‚   â”‚   â”œâ”€â”€ roomController.ts     # æˆ¿é—´ç®¡ç†
â”‚   â”‚   â”‚   â”œâ”€â”€ fileController.ts     # æ–‡ä»¶ä¸Šä¼ 
â”‚   â”‚   â”‚   â””â”€â”€ sseController.ts      # SSEè¿æ¥ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ routes/             # è·¯ç”±å®šä¹‰
â”‚   â”‚   â”‚   â”œâ”€â”€ messageRoutes.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ roomRoutes.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ fileRoutes.ts
â”‚   â”‚   â”‚   â””â”€â”€ sseRoutes.ts
â”‚   â”‚   â”œâ”€â”€ database/           # æ•°æ®åº“
â”‚   â”‚   â”‚   â”œâ”€â”€ init.ts         # æ•°æ®åº“åˆå§‹åŒ–
â”‚   â”‚   â”‚   â””â”€â”€ migrate.ts      # æ•°æ®åº“è¿ç§»
â”‚   â”‚   â”œâ”€â”€ utils/              # å·¥å…·ç±»
â”‚   â”‚   â”‚   â”œâ”€â”€ database.ts     # æ•°æ®åº“è¿æ¥
â”‚   â”‚   â”‚   â””â”€â”€ SSEManager.ts   # SSEæœåŠ¡ç«¯ç®¡ç†å™¨
â”‚   â”‚   â”œâ”€â”€ types.ts            # TypeScriptç±»å‹å®šä¹‰
â”‚   â”‚   â””â”€â”€ app.ts              # Expressåº”ç”¨å…¥å£
â”‚   â”œâ”€â”€ database/               # SQLiteæ•°æ®åº“æ–‡ä»¶
â”‚   â”‚   â””â”€â”€ chat.db
â”‚   â”œâ”€â”€ uploads/                # æ–‡ä»¶ä¸Šä¼ ç›®å½•
â”‚   â”œâ”€â”€ .env                    # ç¯å¢ƒå˜é‡
â”‚   â”œâ”€â”€ package.json
â”‚   â””â”€â”€ tsconfig.json
â”œâ”€â”€ package.json                # æ ¹ç›®å½•åŒ…é…ç½®
â”œâ”€â”€ README.md
â”œâ”€â”€ Technical.md                # æŠ€æœ¯æ–‡æ¡£
â”œâ”€â”€ Structure.md                # ç»“æ„è¯´æ˜
â”œâ”€â”€ Deployment.md               # éƒ¨ç½²æŒ‡å—
â””â”€â”€ API_CONFIG_GUIDE.md         # APIé…ç½®æŒ‡å—
```

## ç³»ç»Ÿæ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           å‰ç«¯ (React 18)                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  App (ChatContext.Provider)       â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚
â”‚  â”‚  â”‚  ChatContainer              â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  â”œâ”€ ChatHeader              â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  â”œâ”€ RoomSelector            â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  â”œâ”€ MessageList             â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  â”œâ”€ MessageInput            â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  â””â”€ ConnectionStatus        â”‚  â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚
â”‚  â”‚  SSEManager (EventSource)         â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚ HTTP/JSON + SSEæµ
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚        åç«¯ (Express + Node.js)         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  app.ts (Expressåº”ç”¨)             â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚  â”‚
â”‚  â”‚  â”‚è·¯ç”±å¤„ç† â”‚  â”‚SSEç®¡ç†å™¨ â”‚        â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚  â”‚
â”‚  â”‚  â”‚æ§åˆ¶å™¨   â”‚  â”‚ä¸šåŠ¡é€»è¾‘ â”‚        â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚ SQL
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          æ•°æ®åº“ (SQLite3)               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ users   â”‚  â”‚ rooms   â”‚  â”‚messages â”‚ â”‚
â”‚  â”‚ status  â”‚  â”‚         â”‚  â”‚         â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

æ•°æ®æµ:
1. ç”¨æˆ·æ“ä½œ â†’ HTTPè¯·æ±‚ â†’ Expressè·¯ç”± â†’ æ§åˆ¶å™¨
2. æ§åˆ¶å™¨ â†’ æ•°æ®åº“æ“ä½œ â†’ å“åº”
3. å‘é€æ¶ˆæ¯ â†’ SSEå¹¿æ’­ â†’ æ‰€æœ‰è®¢é˜…å®¢æˆ·ç«¯
4. æˆ¿é—´åˆ‡æ¢ â†’ æ–­å¼€æ—§SSE â†’ å»ºç«‹æ–°SSE
```

## æ•°æ®åº“è®¾è®¡

### users è¡¨
| å­—æ®µ | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| id | INTEGER | è‡ªå¢ä¸»é”® |
| user_id | TEXT | ç”¨æˆ·è‡ªå®šä¹‰IDï¼ˆå”¯ä¸€ï¼‰ |
| created_at | DATETIME | åˆ›å»ºæ—¶é—´ |

### rooms è¡¨
| å­—æ®µ | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| id | INTEGER | è‡ªå¢ä¸»é”® |
| room_code | CHAR(6) | 6ä½æ•°å­—æˆ¿é—´å·ï¼ˆå”¯ä¸€ï¼‰ |
| room_name | TEXT | æˆ¿é—´åç§° |
| created_by | TEXT | åˆ›å»ºè€…ID |
| admin_users | TEXT | ç®¡ç†å‘˜åˆ—è¡¨(JSON) |
| created_at | DATETIME | åˆ›å»ºæ—¶é—´ |
| is_public | BOOLEAN | æ˜¯å¦å…¬å…±æˆ¿é—´ |

> å…¬å…±å¤§å…: room_code = "PUBLIC", id = 0, is_public = 1

### user_status è¡¨
| å­—æ®µ | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| id | INTEGER | è‡ªå¢ä¸»é”® |
| user_id | TEXT | ç”¨æˆ·IDï¼ˆå”¯ä¸€ï¼‰ |
| room_id | INTEGER | å½“å‰æˆ¿é—´ID |
| is_online | BOOLEAN | æ˜¯å¦åœ¨çº¿ |
| last_seen | DATETIME | æœ€åæ´»è·ƒæ—¶é—´ |

### messages è¡¨
| å­—æ®µ | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| id | INTEGER | è‡ªå¢ä¸»é”® |
| room_id | INTEGER | æˆ¿é—´ID |
| user_id | TEXT | å‘é€è€…ID |
| content | TEXT | æ¶ˆæ¯å†…å®¹ |
| message_type | TEXT | ç±»å‹(text/image/file) |
| file_name | TEXT | æ–‡ä»¶å |
| file_url | TEXT | æ–‡ä»¶URL |
| created_at | DATETIME | å‘é€æ—¶é—´ |

## APIæ¥å£

### æˆ¿é—´ç®¡ç†

| æ¥å£ | æ–¹æ³• | è¯´æ˜ |
|------|------|------|
| `/api/rooms/public` | GET | è·å–å…¬å…±å¤§å…ä¿¡æ¯ |
| `/api/rooms/create` | POST | åˆ›å»ºç§å¯†æˆ¿é—´ |
| `/api/rooms/join/:roomCode` | GET | åŠ å…¥æˆ¿é—´ |

**åˆ›å»ºæˆ¿é—´è¯·æ±‚ä½“ï¼š**
```json
{ "roomCode": "123456", "userId": "user123" }
```

### æ¶ˆæ¯ç®¡ç†

| æ¥å£ | æ–¹æ³• | è¯´æ˜ |
|------|------|------|
| `/api/messages/send` | POST | å‘é€æ¶ˆæ¯ |
| `/api/messages/:roomId` | GET | è·å–æ¶ˆæ¯ï¼ˆè½®è¯¢ï¼‰ |
| `/api/messages/:roomId/latest` | GET | è·å–æœ€æ–°æ¶ˆæ¯ |
| `/api/sse/:roomId` | GET | å»ºç«‹SSEè¿æ¥ |
| `/api/sse/stats` | GET | è·å–SSEè¿æ¥ç»Ÿè®¡ |

**å‘é€æ¶ˆæ¯è¯·æ±‚ä½“ï¼š**
```json
{ "roomId": 1, "userId": "user123", "content": "Hello" }
```

**è½®è¯¢å‚æ•°ï¼š** `?lastMessageId=100`

**SSEè¿æ¥ï¼š** `GET /api/sse/:roomId?userId=user123`

### æ–‡ä»¶ç®¡ç†

| æ¥å£ | æ–¹æ³• | è¯´æ˜ |
|------|------|------|
| `/api/files/upload` | POST | ä¸Šä¼ æ–‡ä»¶(multipart/form-data) |
| `/api/files/:filename` | GET | ä¸‹è½½æ–‡ä»¶ |

## æ ¸å¿ƒæœºåˆ¶

### å®æ—¶æ¶ˆæ¯æ¨é€ (SSE)

**å®¢æˆ·ç«¯å®ç° (client/src/utils/SSEManager.ts):**
- ä½¿ç”¨åŸç”Ÿ EventSource API
- æŒ‡æ•°é€€é¿é‡è¿æœºåˆ¶ (æœ€å¤š5æ¬¡)
- æ”¯æŒäº‹ä»¶ç±»å‹: connected, newMessage, userStatus, error

**æœåŠ¡ç«¯å®ç° (server/src/utils/SSEManager.ts):**
- å•ä¾‹æ¨¡å¼ç®¡ç†æ‰€æœ‰è¿æ¥
- æˆ¿é—´è®¢é˜…æ¨¡å‹
- è‡ªåŠ¨æ¸…ç†æ–­å¼€çš„è¿æ¥

**SSEäº‹ä»¶ç¤ºä¾‹ï¼š**
```typescript
// è¿æ¥ç¡®è®¤
{ "type": "connected", "data": { "roomId": 1, "userId": "user123", "timestamp": "..." } }

// æ–°æ¶ˆæ¯æ¨é€
{ "type": "newMessage", "data": { "id": 101, "userId": "user1", "content": "Hello", "messageType": "text", "createdAt": "..." } }

// ç”¨æˆ·çŠ¶æ€å˜åŒ–
{ "type": "userStatus", "data": { "userId": "user456", "status": "online", "timestamp": "..." } }
```

**SSEä¼˜åŠ¿ï¼š**
- âœ… çœŸæ­£çš„å®æ—¶æ¨é€ï¼Œæ— å»¶è¿Ÿ
- âœ… è‡ªåŠ¨é‡è¿æœºåˆ¶ (æŒ‡æ•°é€€é¿)
- âœ… èµ„æºæ¶ˆè€—ä½ (ç›¸æ¯”è½®è¯¢)
- âœ… åŸç”Ÿæµè§ˆå™¨æ”¯æŒ
- âœ… æ— éœ€WebSocketå¤æ‚é…ç½®

### çŠ¶æ€ç®¡ç† (React Context + useReducer)

**å®ç°ä½ç½®:** `client/src/context/ChatContext.tsx`

**çŠ¶æ€ç»“æ„:**
```typescript
interface AppState {
    currentUser: string;      // å½“å‰ç”¨æˆ·ID
    currentRoom: Room;        // å½“å‰æˆ¿é—´
    messages: Message[];      // æ¶ˆæ¯åˆ—è¡¨
    rooms: Room[];            // å·²åŠ å…¥æˆ¿é—´
    isConnected: boolean;     // è¿æ¥çŠ¶æ€
    isLoading: boolean;       // åŠ è½½çŠ¶æ€
}
```

**Actionç±»å‹:**
- SET_USER / SET_ROOM - è®¾ç½®ç”¨æˆ·/æˆ¿é—´
- SET_MESSAGES / ADD_MESSAGES - è®¾ç½®/æ·»åŠ æ¶ˆæ¯
- SET_LOADING / SET_CONNECTED - è®¾ç½®çŠ¶æ€

### æˆ¿é—´åˆ‡æ¢æµç¨‹

1. ç”¨æˆ·è¾“å…¥6ä½æˆ¿é—´å·
2. å°è¯•åŠ å…¥æˆ¿é—´ (`/api/rooms/join/:code`)
3. è‹¥æˆ¿é—´ä¸å­˜åœ¨ï¼Œè‡ªåŠ¨åˆ›å»º (`/api/rooms/create`)
4. **æ›´æ–°React ContextçŠ¶æ€**
5. æ–­å¼€æ—§æˆ¿é—´SSEè¿æ¥
6. å»ºç«‹æ–°æˆ¿é—´SSEè¿æ¥
7. è·å–å†å²æ¶ˆæ¯ (`/api/messages/:roomId/latest`)
8. ç­‰å¾…SSEå®æ—¶æ¨é€

## ç¯å¢ƒé…ç½®

### åç«¯ (server/.env)
```env
PORT=3001
DATABASE_PATH=./database/chat.db
NODE_ENV=development
UPLOAD_DIR=./uploads
MAX_FILE_SIZE=10485760
```

### å‰ç«¯ (client/.env)
```env
VITE_API_BASE_URL=/api
```

## éƒ¨ç½²

### å¼€å‘ç¯å¢ƒ
```bash
bun run dev              # åŒæ—¶å¯åŠ¨å‰åç«¯
bun run server:dev       # ä»…åç«¯ (ç«¯å£3001)
bun run client:dev       # ä»…å‰ç«¯ (ç«¯å£5173)
```

### ç”Ÿäº§ç¯å¢ƒ
```bash
# æ„å»º
cd client && bun run build
cd ../server && bun run build

# å¯åŠ¨
bun start
```

### PM2éƒ¨ç½²
```bash
pm2 start server/dist/app.js --name "chat-server"
pm2 startup && pm2 save
```

### Nginxé…ç½®
```nginx
server {
    listen 80;
    server_name your-domain.com;

    location / {
        root /path/to/client/dist;
        try_files $uri $uri/ /index.html;
    }

    location /api {
        proxy_pass http://localhost:3001;
        proxy_http_version 1.1;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        
        # SSEç‰¹æ®Šé…ç½®
        proxy_set_header Connection '';
        proxy_set_header Cache-Control no-cache;
        proxy_set_header X-Accel-Buffering no;
        proxy_buffering off;
    }

    location /uploads {
        proxy_pass http://localhost:3001;
        client_max_body_size 10M;
    }
}
```

### SSEéƒ¨ç½²æ³¨æ„äº‹é¡¹

1. **åå‘ä»£ç†é…ç½®**
   - å¿…é¡»ç¦ç”¨ç¼“å†²ï¼š`proxy_buffering off`
   - è®¾ç½®è¿æ¥å¤´ä¸ºç©ºï¼š`proxy_set_header Connection ''`
   - ç¦ç”¨ç¼“å­˜ï¼š`proxy_set_header Cache-Control no-cache`

2. **è´Ÿè½½å‡è¡¡**
   - SSEè¿æ¥éœ€è¦ä¼šè¯ä¿æŒ
   - ä½¿ç”¨IPå“ˆå¸Œæˆ–ä¸€è‡´æ€§å“ˆå¸Œç®—æ³•
   - é¿å…è·¨æœåŠ¡å™¨è¿æ¥é—®é¢˜

3. **ç›‘æ§æŒ‡æ ‡**
   - è¿æ¥æ•°é‡ç›‘æ§
   - æ¶ˆæ¯å»¶è¿Ÿç›‘æ§
   - é‡è¿é¢‘ç‡ç›‘æ§

## å¸¸è§é—®é¢˜

### ç«¯å£å ç”¨
```bash
# Windows
netstat -ano | findstr :3001
taskkill /PID <PID> /F

# Linux/macOS
lsof -i :3001
kill -9 <PID>
```

### ä¾èµ–å®‰è£…å¤±è´¥
```bash
rm -rf node_modules bun.lockb
bun install
```

### æ–‡ä»¶ä¸Šä¼ å¤±è´¥
```bash
mkdir -p server/uploads
chmod 755 server/uploads
```

## ä½¿ç”¨è¯´æ˜

1. **ç™»å½•** - è¾“å…¥è‡ªå®šä¹‰ç”¨æˆ·ID
2. **å…¬å…±å¤§å…** - é»˜è®¤è¿›å…¥ï¼Œæ‰€æœ‰ç”¨æˆ·å¯è§
3. **ç§å¯†æˆ¿é—´** - è¾“å…¥6ä½æ•°å­—åˆ›å»º/åŠ å…¥
4. **å‘é€æ¶ˆæ¯** - è¾“å…¥æ¡†è¾“å…¥ï¼ŒEnterå‘é€
5. **ä¸Šä¼ æ–‡ä»¶** - ç‚¹å‡»ğŸ“æŒ‰é’®ï¼Œæ”¯æŒå›¾ç‰‡å’Œæ–‡æ¡£

---

**ç‰ˆæœ¬**: v1.0.0  
**çŠ¶æ€**: âœ… å·²å®Œæˆ  
**åŒ…ç®¡ç†å™¨**: Bun 1.0+
